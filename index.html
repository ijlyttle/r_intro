<!DOCTYPE html>
<html>
<head>
  <title>Introduction to R &amp; RStudio</title>
  <meta charset="utf-8">
  <meta name="description" content="Introduction to R &amp; RStudio">
  <meta name="author" content="Ian Lyttle">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->  <link rel=stylesheet href="./assets/css/ribbons.css"></link>
<link rel=stylesheet href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"></link>

  
  <!-- Grab CDN jQuery, fall back to local if offline -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery.js"><\/script>')</script> 
  <script data-main="libraries/frameworks/io2012/js/slides" 
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>
  
  

</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
        <slide class="title-slide segue nobackground">
  <hgroup class="auto-fadein">
    <h1>Introduction to R &amp; RStudio</h1>
    <h2></h2>
    <p>Ian Lyttle<br/>Analytics for Solutions, Schneider Electric</p>
  </hgroup>
  <article></article>  
</slide>
    

    <!-- SLIDES -->
    <slide class="" id="slide-1" style="background:;">
  <hgroup>
    <h2>Introduction</h2>
  </hgroup>
  <article data-timings="">
    <p>There are other options for open-source data analysis: Octave, Python, and Rapid Miner (GUI).</p>

<p>This presentation focuses on R and RStudio:</p>

<ul>
<li><p>R is an <b>outstanding</b> tool for prototyping a data-analysis.</p></li>
<li><p>Everything demonstrated here is available without license fees.</p></li>
<li><p>There is an investment in yourself to learn. It will be frustrating.</p></li>
<li><p>Exchange of programs and snippets is simple exchange of text.</p></li>
</ul>

<p>Warning:</p>

<ul>
<li><p>about 80% of data-analysis is simply wrestling with data</p></li>
<li><p>does not lend itself to an introductory presentation</p></li>
</ul>

<p><i class="fa fa-link"></i> <a href="http://www.gnu.org/software/octave/">Octave</a>
<i class="fa fa-link"></i> <a href="http://www.python.org/">Python</a>
<i class="fa fa-link"></i> <a href="http://rapidminer.com/">Rapid Miner</a> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-2" style="background:;">
  <hgroup>
    <h2>This presentation</h2>
  </hgroup>
  <article data-timings="">
    <h3>Philosohpy</h3>

<p>I want to show as many features as I can in an hour.</p>

<p>An hour, even a week, is not enough time for thoughful discussion, demonstration, and practice.  </p>

<p>I have tried to leave links to other references, so that you may learn at your pace.</p>

<p>Everything in this presentation is reproducible - all the R code is shown.</p>

<h3>More help (?$%<sup>#!!)</sup></h3>

<p>Google is your friend</p>

<p>Stack Overflow (likely someone has already asked)</p>

<p>Informal R networks at work</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-3" style="background:;">
  <hgroup>
    <h2>Installation</h2>
  </hgroup>
  <article data-timings="">
    <p>You will need to install:</p>

<ul>
<li><p>Base R: <a href="http://www.r-project.org/">www.r-project.org</a> </p>

<p>The <code>0-Cloud</code> archive works well. </p></li>
<li><p>RStudio IDE: <a href="http://www.rstudio.com">www.rstudio.com</a></p></li>
</ul>

<p>In general, install the latest versions; the defaults work very well. </p>

<p>Some helpful videos from Amanda Traud:</p>

<ul>
<li><i class="fa fa-youtube"></i> <a href="http://youtu.be/X_oFb2iAdu8">Installing R</a></li>
<li><i class="fa fa-youtube"></i> <a href="http://youtu.be/AZPbg29Plpw">Installing RStudio</a></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-4" style="background:;">
  <hgroup>
    <h2>Tour of RStudio IDE</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:33%'>
 <p><code>Screencast</code> at</p>

<p><i class="fa fa-play-circle-o"></i> <a href="http://www.rstudio.com/ide/">www.rstudio.com/ide</a></p>

</div>
<div class='right' style='float:right;width:65%'>
 <p><img src="figure/rstudio-windows.png", width="100%"/></p>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-5" style="background:;">
  <hgroup>
    <h2>Vectors</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:33%'>
 <p>Collection of like objects</p>

<p>Assembled using <code>c()</code></p>

</div>
<div class='right' style='float:right;width:65%'>
 <pre><code class="r">a &lt;- c(1, 2, 3)
b &lt;- c(4, 5, 6)
a
</code></pre>

<pre><code>[1] 1 2 3
</code></pre>

<pre><code class="r">b
</code></pre>

<pre><code>[1] 4 5 6
</code></pre>

<pre><code class="r">c(a, b)
</code></pre>

<pre><code>[1] 1 2 3 4 5 6
</code></pre>

</div>
<div class='foot' style='float:left;width:100%'>
 <p>GoogleDeveloplers <i class="fa fa-youtube"></i> 
<a href="http://youtu.be/YhQOV27pQfg">Create and Work With Vectors</a></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-6" style="background:;">
  <hgroup>
    <h2>Vectors</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:33%'>
 <p>Can be:</p>

<ul>
<li>numeric</li>
<li>character</li>
<li>logical</li>
</ul>

</div>
<div class='right' style='float:right;width:65%'>
 <pre><code class="r">c(1,2)
</code></pre>

<pre><code>[1] 1 2
</code></pre>

<pre><code class="r">c(&quot;Square D&quot;, &quot;Merlin Gerin&quot;)
</code></pre>

<pre><code>[1] &quot;Square D&quot;     &quot;Merlin Gerin&quot;
</code></pre>

<pre><code class="r">c(TRUE, FALSE)
</code></pre>

<pre><code>[1]  TRUE FALSE
</code></pre>

</div>
<div class='foot' style='float:left;width:100%'>
 <p>GoogleDeveloplers <i class="fa fa-youtube"></i> 
<a href="http://youtu.be/GKu5tw_bIpA">Character and Boolean Vectors</a></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-7" style="background:;">
  <hgroup>
    <h2>Lists</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:33%'>
 <p>Collections of not-necessarily like objects</p>

</div>
<div class='right' style='float:right;width:65%'>
 <pre><code class="r">a &lt;- list(title=&quot;Star Wars&quot;, year=1977)
a
</code></pre>

<pre><code>$title
[1] &quot;Star Wars&quot;

$year
[1] 1977
</code></pre>

<pre><code class="r">a$title
</code></pre>

<pre><code>[1] &quot;Star Wars&quot;
</code></pre>

</div>
<div class='foot' style='float:left;width:100%'>
 <p>GoogleDeveloplers <i class="fa fa-youtube"></i> 
<a href="http://youtu.be/UffunYeERV0">Lists</a></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-8" style="background:;">
  <hgroup>
    <h2>Data Frames</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:40%'>
 <p>This is where the &quot;action&quot; is. </p>

<p>Data frames are lists where each member is a vector of the same length.</p>

<p>Rows often called &quot;observations&quot;</p>

<p>Columns often called &quot;variables&quot;</p>

</div>
<div class='right' style='float:right;width:55%'>
 <pre><code class="r">a &lt;- data.frame(title=c(&quot;Star Wars&quot;, 
                        &quot;The Empire Strikes Back&quot;,
                        &quot;Return of the Jedi&quot;),
                year=c(1977, 1980, 1983))
a
</code></pre>

<pre><code>                    title year
1               Star Wars 1977
2 The Empire Strikes Back 1980
3      Return of the Jedi 1983
</code></pre>

</div>
<div class='foot' style='float:left;width:100%'>
 <p>To import a csv file into a data frame, use <code>read.csv()</code> function. </p>

<p>Be mindful of options such as <code>quote</code>, <code>header</code>.</p>

<p>GoogleDeveloplers <i class="fa fa-youtube"></i>
<a href="http://youtu.be/qK1ElUMkhq0">Loading Data and Working With Data Frames</a></p>

<p>GoogleDeveloplers <i class="fa fa-youtube"></i>
<a href="http://youtu.be/cx_3zWo4sUs">Loading Data, Object Summaries, and Dates</a></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-9" style="background:;">
  <hgroup>
    <h2>Packages</h2>
  </hgroup>
  <article data-timings="">
    <p>User-contributed packages are a big part of R&#39;s success.</p>

<p>Here&#39;s a subjective list of &quot;essential&quot; packages to be installed:</p>

<table><thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td><code>plyr</code></td>
<td>data transformation</td>
<td><a href="http://plyr.had.co.nz/">Website</a>, <a href="http://www.jstatsoft.org/v40/i01/paper">JSS Article</a></td>
</tr>
<tr>
<td><code>reshape2</code></td>
<td>data transformation</td>
<td><a href="http://had.co.nz/reshape/">Website</a>, <a href="http://www.jstatsoft.org/v21/i12/paper">JSS Article</a></td>
</tr>
<tr>
<td><code>ggplot2</code></td>
<td>visualization</td>
<td><a href="http://ggplot2.org/">Website</a>, <a href="http://www.cookbook-r.com/Graphs/">Cookbook</a>, <a href="http://docs.ggplot2.org/current/">Reference</a></td>
</tr>
<tr>
<td><code>stringr</code></td>
<td>work with strings</td>
<td><a href="http://journal.r-project.org/archive/2010-2/RJournal_2010-2_Wickham.pdf">R Journal Article</a></td>
</tr>
<tr>
<td><code>lubridate</code></td>
<td>work with date-times</td>
<td><a href="http://www.jstatsoft.org/v40/i03/paper">JSS Article</a></td>
</tr>
</tbody></table>

<p><br/></p>

<p>One consequence of user-contributed packages is a lack of consistency in interface.</p>

<p>Hadley Wickham&#39;s contribution is a set of useful packges that are well-written, well-documented, and well-consistent.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-10" style="background:;">
  <hgroup>
    <h2>Package Installation</h2>
  </hgroup>
  <article data-timings="">
    <p>To install a package, you can use the command-line:</p>

<pre><code class="r">install_packages(&quot;reshape2&quot;)
install_packages(&quot;plyr&quot;)
install_packages(&quot;ggplot2&quot;)
</code></pre>

<p>To load a package:</p>

<pre><code class="r">require(&quot;reshape2&quot;, quietly=TRUE)
require(&quot;plyr&quot;, quietly=TRUE)
require(&quot;ggplot2&quot;, quietly=TRUE)
</code></pre>

<p><code>require()</code> and <code>library()</code> are used interchangably.</p>

<p>Using RStudio IDE: Andrew Jahn  <i class="fa fa-youtube"></i>
<a href="http://youtu.be/u1r5XTqrCTQ">Installing Packages in R Studio</a> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-11" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    <h3>Residential Energy Demand Temperature Index</h3>

<div class='left' style='float:left;width:40%'>
 <ul>
<li><p>import using <code>read.csv()</code></p></li>
<li><p>functions to tidy and clean data</p></li>
<li><p>subsetting</p></li>
<li><p>visualization using <code>ggplot2</code></p></li>
<li><p>model using <code>lm()</code></p></li>
<li><p>predict using <code>predict()</code>, <code>resid()</code></p></li>
</ul>

</div>
<div class='right' style='float:right;width:60%'>
 <p><img src="figure/us_redti_spring.jpg", width="85%"/></p>

</div>
<div class='foot' style='float:left;width:100%'>
 <p>Purpose is to highlight the some steps in an analysis, not to show a complete analysis</p>

<p><i class="fa fa-link"></i> <a href="http://www.ncdc.noaa.gov/societal-impacts/redti/">U.S. National Climatic Data Center</a></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-12" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    <h3>Import the data</h3>

<p>Install these packages first, using <code>install.packages()</code>, if you don&#39;t have them.</p>

<pre><code class="r">library(reshape2, quietly=TRUE)
library(plyr, quietly=TRUE)
library(ggplot2, quietly=TRUE)
</code></pre>

<p>Read csv file, parse into data frame</p>

<pre><code class="r">us_redti_raw &lt;- 
  read.csv(&quot;http://ijlyttle.github.io/r_intro/data/us_redti_consumption.csv&quot;)
</code></pre>

<p><br/>
Preview: 
<i class="fa fa-link"></i> <a href="https://github.com/ijlyttle/r_intro/blob/master/data/us_redti_consumption.csv">us_redti_consumption.csv</a> </p>

<div class='left' style='float:left;width:33%'>
 
</div>
<div class='right' style='float:right;width:65%'>
 
</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-13" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:60%'>
 <h3>Tidy data</h3>

<p>Variables are stored in columns</p>

<p>Observations are stored in rows</p>

<p>Single type of experimental unit per dataset </p>

</div>
<div class='right' style='float:right;width:40%'>
 <pre><code class="r">head(us_redti_raw)
</code></pre>

<pre><code>  Year  Winter Spring Summer Fall
1 1973  -99.99   2579   1499 1951
2 1974 3628.97   2489   1496 1884
3 1975 3627.84   2726   1489 1775
4 1976 3816.05   2424   1519 2047
5 1977 4374.53   2304   1513 1859
6 1978 3953.53   2600   1545 1922
</code></pre>

<p>This is <b>not</b> tidy data.</p>

<p>&quot;Winter&quot; is a season, not a variable.
<br/></p>

</div>
<div class='foot' style='float:left;width:100%'>
 <p>Hadley Wickham <i class="fa fa-vimeo-square"></i> <a href="http://vimeo.com/33727555">Tidy Data</a>  <i class="fa fa-link"></i> <a href="http://vita.had.co.nz/papers/tidy-data.pdf">Paper</a></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-14" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    <h3>Tidy data</h3>

<p><code>reshape2</code> provides some tidying tools, such as the <code>melt()</code> function.</p>

<div class='left' style='float:left;width:65%'>
 <pre><code class="r">us_redti_tidy &lt;- melt(
  us_redti_raw,              # input data frame 
  id.vars = &quot;Year&quot;,          # vars *not* to be melted
  variable.name = &quot;season&quot;,  # column for melted var-names
  value.name = &quot;consumption&quot; # column for melted values  
)
</code></pre>

</div>
<div class='right' style='float:right;width:35%'>
 <pre><code class="r">head(us_redti_tidy)
</code></pre>

<pre><code>  Year season consumption
1 1973 Winter      -99.99
2 1974 Winter     3628.97
3 1975 Winter     3627.84
4 1976 Winter     3816.05
5 1977 Winter     4374.53
6 1978 Winter     3953.53
</code></pre>

</div>
<div class='foot' style='float:left;width:100%'>
 <p>The function <code>dcast()</code> is used to reverse the process.</p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-15" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">summary(us_redti_tidy)    # Useful functions to examine data
</code></pre>

<pre><code>      Year         season    consumption  
 Min.   :1973   Winter:29   Min.   :-100  
 1st Qu.:1980   Spring:29   1st Qu.:1686  
 Median :1987   Summer:29   Median :2104  
 Mean   :1987   Fall  :29   Mean   :2301  
 3rd Qu.:1994               3rd Qu.:2678  
 Max.   :2001               Max.   :4406  
</code></pre>

<pre><code class="r">str(us_redti_tidy)        # Can also use RStudio GUI
</code></pre>

<pre><code>&#39;data.frame&#39;:   116 obs. of  3 variables:
 $ Year       : int  1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 ...
 $ season     : Factor w/ 4 levels &quot;Winter&quot;,&quot;Spring&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
 $ consumption: num  -100 3629 3628 3816 4375 ...
</code></pre>

<div class='left' style='float:left;width:50%'>
 
</div>
<div class='right' style='float:right;width:50%'>
 
</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-16" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    <h3>Clean data</h3>

<p>In our dataset, <code>-99.99</code> denotes missing data. In R, <code>NA</code> is used for this purpose.</p>

<p>Let&#39;s use a function to fix the &quot;missing&quot; values. This one was written by Hadley:</p>

<pre><code class="r">fix_missing &lt;- function(x, na.value) {
  x[x == na.value] &lt;- NA                # for those values of x equal to na.value,
  x                                     # replace the value with NA                                   
} 
</code></pre>

<p>This function:</p>

<ul>
<li><p>takes a vector, <code>x</code>, and a value, <code>na.value</code>.</p></li>
<li><p>returns a vector replicating <code>x</code>, where <code>na.value</code> is replaced by <code>NA</code>. </p></li>
</ul>

<p>Hadley Wickham <i class="fa fa-link"></i> 
<a href="http://adv-r.had.co.nz/Functional-programming.html">Advanced R: Functional Programming</a></p>

<div class='left' style='float:left;width:50%'>
 
</div>
<div class='right' style='float:right;width:50%'>
 
</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-17" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    <h3>Clean data</h3>

<p>The <code>mutate()</code> function from the <code>plyr</code> package is useful.</p>

<p>Mutate a data frame by adding new or replacing existing columns</p>

<div class='left' style='float:left;width:50%'>
 <pre><code class="r">us_redti_clean &lt;- mutate(
  us_redti_tidy,
  consumption = 
    fix_missing(consumption,  -99.99)
)
</code></pre>

</div>
<div class='right' style='float:right;width:50%'>
 <pre><code class="r">summary(us_redti_clean)
</code></pre>

<pre><code>      Year         season    consumption  
 Min.   :1973   Winter:29   Min.   :1335  
 1st Qu.:1980   Spring:29   1st Qu.:1725  
 Median :1987   Summer:29   Median :2135  
 Mean   :1987   Fall  :29   Mean   :2387  
 3rd Qu.:1994               3rd Qu.:2866  
 Max.   :2001               Max.   :4406  
                            NA&#39;s   :4     
</code></pre>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-18" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:45%'>
 <h3>Visualize data</h3>

<p><code>qplot()</code> from <code>ggplot2</code> package</p>

<pre><code class="r">plot_cons &lt;- qplot(
  x = Year,
  y = consumption,
  color = season,
  data = us_redti_clean
)
</code></pre>

<pre><code class="r">plot_cons
</code></pre>

</div>
<div class='right' style='float:right;width:55%'>
 <p><img src="figure/unnamed-chunk-13.png" title="plot of chunk unnamed-chunk-13" alt="plot of chunk unnamed-chunk-13" style="display: block; margin: auto;" /></p>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-19" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:45%'>
 <h3>Detrend data</h3>

<p>We want to remove the time-trend effects for data after 1979.</p>

<pre><code class="r">index_later &lt;-     # identify indices
  us_redti_clean$Year &gt; 1979

us_redti_later &lt;-  # subset on indices
  us_redti_clean[index_later, ]

plot_cons +        # add to plot
  geom_smooth(
    data = us_redti_later,
    method = &quot;lm&quot;
  )
</code></pre>

</div>
<div class='right' style='float:right;width:55%'>
 <p><img src="figure/unnamed-chunk-15.png" title="plot of chunk unnamed-chunk-15" alt="plot of chunk unnamed-chunk-15" style="display: block; margin: auto;" /></p>

<h2>Case Study: U.S. REDTI</h2>

<h3>Detrend data</h3>

<p>Although we can do this more generally, we will demonstrate by subsetting on winter</p>

<pre><code class="r">us_redti_later_winter &lt;- us_redti_later[us_redti_later$season == &quot;Winter&quot;, ]
</code></pre>

<p>The <code>lm()</code> function returns a linear model.</p>

<pre><code class="r">model_time_winter &lt;- lm(
  consumption ~ Year,            # independent variable ~ dependent variable(s), &quot;1&quot; implied
  data = us_redti_later_winter   # man page is very useful
)
coef(summary(model_time_winter)) # summary() gives more info; we want just coefficients for now
</code></pre>

<pre><code>             Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept) -56817.64  12327.119  -4.609 1.697e-04
Year            30.38      6.193   4.906 8.531e-05
</code></pre>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-20" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    <h3>Detrend data</h3>

<p>Use <code>predict()</code> to establish baseline at 1980.</p>

<pre><code class="r">consumption_baseline &lt;- 
  predict(model_time_winter, newdata=data.frame(Year = 1980))

consumption_baseline
</code></pre>

<pre><code>   1 
3341 
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-21" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    <h3>Detrend data</h3>

<p>Use <code>resid()</code></p>

<p>Use <code>mutate()</code> to create detrended data frame</p>

<pre><code class="r">us_redti_later_winter_dt &lt;- mutate(
  us_redti_later_winter,
  detrended = TRUE,
  consumption = consumption_baseline + resid(model_time_winter) 
)

us_redti_later_winter$detrended &lt;- FALSE
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-22" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    <h3>Detrend data</h3>

<p>Compare original and detrended data-frames</p>

<div class='left' style='float:left;width:50%'>
 <pre><code class="r">head(us_redti_later_winter)
</code></pre>

<pre><code>   Year season consumption detrended
8  1980 Winter        3472     FALSE
9  1981 Winter        3630     FALSE
10 1982 Winter        3536     FALSE
11 1983 Winter        3285     FALSE
12 1984 Winter        3438     FALSE
13 1985 Winter        3465     FALSE
</code></pre>

</div>
<div class='right' style='float:right;width:50%'>
 <pre><code class="r">head(us_redti_later_winter_dt)
</code></pre>

<pre><code>   Year season consumption detrended
8  1980 Winter        3472      TRUE
9  1981 Winter        3600      TRUE
10 1982 Winter        3476      TRUE
11 1983 Winter        3194      TRUE
12 1984 Winter        3317      TRUE
13 1985 Winter        3313      TRUE
</code></pre>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-23" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. REDTI</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:50%'>
 <h3>Detrend data</h3>

<pre><code class="r"># combine data frames by binding rows
us_redti_combined &lt;- rbind(
  us_redti_later_winter,
  us_redti_later_winter_dt
)

plot_detrend &lt;- 
  qplot(
    x = Year,
    y = consumption,
    color = detrended,
    data = us_redti_combined,
    geom = &quot;point&quot;
  ) + 
  geom_smooth(method=&quot;lm&quot;)
</code></pre>

</div>
<div class='right' style='float:right;width:50%'>
 <p><img src="figure/unnamed-chunk-23.png" title="plot of chunk unnamed-chunk-23" alt="plot of chunk unnamed-chunk-23" style="display: block; margin: auto;" /></p>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-24" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:33%'>
 <h3>Demonstration</h3>

<ul>
<li><p>import using <code>read.csv()</code></p></li>
<li><p>aggregation using <code>plyr</code></p></li>
<li><p>visualization using <code>ggplot2</code></p></li>
<li><p>interacivity using <code>rCharts</code></p></li>
</ul>

</div>
<div class='right' style='float:right;width:65%'>
 <p><img src="figure/primary_energy_consume_source_sector_2012_endnotes.jpg", width="100%"/></p>

</div>
<div class='foot' style='float:left;width:100%'>
 <p>Source: <i class="fa fa-link"></i> <a href="http://www.eia.gov/energy_in_brief/article/major_energy_sources_and_users.cfm">U.S. Energy Information Administration</a></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-25" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    <h3>Import the data</h3>

<pre><code class="r"># install these packages, if you don&#39;t have them
library(plyr, quietly=TRUE)
library(ggplot2, quietly=TRUE)
# read this csv file; parse into a data frame 
us_energy_2012 &lt;- read.csv(&quot;http://ijlyttle.github.io/r_intro/data/us_energy_2012.csv&quot;)
</code></pre>

<pre><code class="r"># advanced
install.packages(devtools)
library(devtools, quietly=TRUE) # requires RTools from CRAN 
install_github(repo=&quot;rCharts&quot;, username=&quot;ramnathv&quot;, ref=&quot;dev&quot;)
library(rCharts, quietly=TRUE)
</code></pre>

<p><br/>
 Preview: <i class="fa fa-link"></i> <a href="https://github.com/ijlyttle/r_intro/blob/master/data/us_energy_2012.csv">us_energy_2012.csv</a></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-26" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    <h3>Examine the data</h3>

<pre><code class="r">head(us_energy_2012) # print the first six lines
</code></pre>

<pre><code>       source                 sector consumption
1   petroleum         transportation      24.637
2   petroleum             industrial       7.981
3   petroleum residential_commercial       1.735
4   petroleum         electric_power       0.347
5 natural_gas         transportation       0.780
6 natural_gas             industrial       8.580
</code></pre>

<p>Note that the consumption is expressed in quads (\(10^{15}\) BTU).</p>

<p>Keeping track of metadata such as units is a challenge.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-27" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    <h3>Aggregate by source</h3>

<pre><code class="r">us_energy_by_source_2012 &lt;- ddply(  # transform data-frame to data_frame
  .data = us_energy_2012,           # input data-frame
  .variable = .(source),            # split by variable &quot;source&quot;
  .fun = summarize,                 # use summarize() function 
  consumption = sum(consumption)    # column &quot;consumption&quot; in output data-frame
)                                   #   is sum of column &quot;consumption&quot; in input data-frame

us_energy_by_source_2012
</code></pre>

<pre><code>       source consumption
1        coal        17.4
2 natural_gas        26.0
3     nuclear         8.1
4   petroleum        34.7
5   renewable         8.9
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-28" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    <h3>Aggregate by sector</h3>

<pre><code class="r">us_energy_by_source_2012 &lt;- ddply(  # transform data-frame to data_frame
  .data = us_energy_2012,           # input data-frame
  .variable = .(sector),            # split by variable &quot;sector&quot;
  .fun = summarize,                 # use summarize() function 
  consumption = sum(consumption)    # column &quot;consumption&quot; in output data-frame
)                                   #   is sum of column &quot;consumption&quot; in input data-frame

us_energy_by_source_2012
</code></pre>

<pre><code>                  sector consumption
1         electric_power      38.288
2             industrial      20.352
3 residential_commercial       9.886
4         transportation      26.574
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-29" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:45%'>
 <h3>Stacked bar plot</h3>

<pre><code class="r">plot_1 &lt;- qplot(
  x = source,
  y = consumption,
  fill = sector,
  data = us_energy_2012,
  geom = &quot;bar&quot;,
  stat = &quot;identity&quot;,
  ylab = &quot;consumption (quads)&quot;,
  main = &quot;U.S. Energy Consumption 2012&quot;
)
</code></pre>

</div>
<div class='right' style='float:right;width:55%'>
 <p><img src="figure/plot_1_vis.png" title="plot of chunk plot_1_vis" alt="plot of chunk plot_1_vis" style="display: block; margin: auto;" /></p>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-30" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:45%'>
 <h3>Dodged bar plot</h3>

<pre><code class="r">plot_2 &lt;- qplot(
  x = source,
  y = consumption,
  fill = sector,
  data = us_energy_2012,
  geom = &quot;bar&quot;,
  stat = &quot;identity&quot;,
  position = &quot;dodge&quot;,
  ylab = &quot;consumption (quads)&quot;,
  main = &quot;U.S. Energy Consumption 2012&quot;
)
</code></pre>

</div>
<div class='right' style='float:right;width:55%'>
 <p><img src="figure/plot_2_vis.png" title="plot of chunk plot_2_vis" alt="plot of chunk plot_2_vis" style="display: block; margin: auto;" /></p>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-31" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:45%'>
 <h3>Faceted bar plot</h3>

<pre><code class="r">plot_3 &lt;- qplot(
  x = source,
  y = consumption,
  data = us_energy_2012,
  geom = &quot;bar&quot;,
  stat = &quot;identity&quot;,
  facets = sector ~ .,
  ylab = &quot;consumption (quads)&quot;,
  main = &quot;U.S. Energy Consumption 2012&quot;
) + 
  coord_flip()
</code></pre>

</div>
<div class='right' style='float:right;width:55%'>
 <p><img src="figure/plot_3_vis.png" title="plot of chunk plot_3_vis" alt="plot of chunk plot_3_vis" style="display: block; margin: auto;" /></p>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-32" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r"># Using `rCharts` and `NVD3` (http://nvd3.org/)
n1 &lt;- nPlot(consumption ~ source, group=&quot;sector&quot;, data=us_energy_2012, type=&#39;multiBarChart&#39;)
n1$yAxis(axisLabel = &quot;consumption (quads)&quot;, width=45)
</code></pre>

<iframe src=figure/nvd3_vis.html seamless></iframe>

<div class='left' style='float:left;width:40%'>
 
</div>
<div class='right' style='float:right;width:60%'>
 
</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-33" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r"># Using `rCharts` and `NVD3` (http://nvd3.org/)
n1 &lt;- nPlot(consumption ~ sector, group=&quot;source&quot;, data=us_energy_2012, type=&#39;multiBarChart&#39;)
n1$yAxis(axisLabel = &quot;consumption (quads)&quot;, width=45)
</code></pre>

<iframe src=figure/nvd3_2_vis.html seamless></iframe>

<div class='left' style='float:left;width:40%'>
 
</div>
<div class='right' style='float:right;width:60%'>
 
</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-34" style="background:;">
  <hgroup>
    <h2>Case Study: U.S. Energy 2012</h2>
  </hgroup>
  <article data-timings="">
    
<div class='left' style='float:left;width:60%'>
 <pre><code class="r"># Using `rCharts` to make a Sankey plot
sankey_lib &lt;- 
  &#39;http://timelyportfolio.github.io/rCharts_d3_sankey&#39;
sankeyPlot &lt;- rCharts$new()
sankeyPlot$setLib(sankey_lib)
sankeyPlot$set(
  data = summarize(
    us_energy_2012[us_energy_2012$consumption &gt; 0, ],
    source,
    target = sector,
    value = consumption
  ),
  layout = 32,
  nodeWidth = 20, nodePadding = 5,
  width = 375, height = 475
)
</code></pre>

<p><i class="fa fa-link"></i> <a href="http://timelyportfolio.github.io/rCharts_d3_sankey/example_build_network_sankey.html">timelyportfolio Sankey diagrams</a></p>

</div>
<div class='right' style='float:right;width:40%'>
 <iframe src=figure/sankey_vis.html seamless></iframe>

</div>
<div class='foot' style='float:left;width:100%'>
 
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-35" style="background:;">
  <hgroup>
    <h2>Further Learning</h2>
  </hgroup>
  <article data-timings="">
    <table><thead>
<tr>
<th>Introductory</th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>Hadley Wickham <i class="fa fa-youtube"></i> <a href="http://youtu.be/TaxJwC_MP9Q">Google Tech Talk</a></td>
<td>Use of programming languages for data analysis <i class="fa fa-coffee"></i></td>
</tr>
<tr>
<td>GoogleDeveloplers <i class="fa fa-youtube"></i>  <a href="http://www.youtube.com/playlist?list=PLOU2XLYxmsIK9qQfztXeybpHvru-TrqAP">Introduction to R</a></td>
<td>Great set of short videos introducing the basics</td>
</tr>
<tr>
<td>Norman Matloff <i class="fa fa-book"></i> <a href="http://amzn.com/1593273843">The Art of R Programming</a></td>
<td>Solid tutorial introduction</td>
</tr>
<tr>
<td>Garrett Grolemund  <i class="fa fa-book"></i> <a href="http://amzn.com/1449359019">Data Analysis with R</a></td>
<td>Incorporates Hadley packages <code>plyr</code>, <code>ggplot2</code>. Avail. June 2014</td>
</tr>
<tr>
<td>Hadley Wickham <i class="fa fa-vimeo-square"></i> <a href="http://vimeo.com/33727555">Tidy Data</a>  <i class="fa fa-link"></i> <a href="http://vita.had.co.nz/papers/tidy-data.pdf">Paper</a></td>
<td>Essential work on how organizing data (even for non-R people) <i class="fa fa-coffee"></i></td>
</tr>
</tbody></table>

<p><br/></p>

<table><thead>
<tr>
<th>Advanced</th>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>Yihui Xie  <i class="fa fa-link"></i> <a href="http://yihui.name/knitr/">knitr</a></td>
<td>Reporoducible research: dynamic report generation</td>
</tr>
<tr>
<td>Ramnath Vaidyanathan <i class="fa fa-github"></i>  <a href="http://slidify.org/">slidify</a></td>
<td>Create html5 presentations, blog posts using R</td>
</tr>
<tr>
<td>Ramnath Vaidyanathan  <i class="fa fa-github"></i> <a href="http://ramnathv.github.io/rCharts/">rCharts</a></td>
<td>Create <code>d3.js</code> charts using R</td>
</tr>
<tr>
<td>Rstudio <i class="fa fa-link"></i> <a href="http://www.rstudio.com/shiny/">shiny</a></td>
<td>Create interactive web-applications using R</td>
</tr>
<tr>
<td>Hadley Wickham <i class="fa fa-link"></i> <a href="http://adv-r.had.co.nz/">Advanced R</a></td>
<td>Learn what&#39;s behind the curtain</td>
</tr>
</tbody></table>

<p><br/>
<i class="fa fa-coffee"></i> - longer video</p>

  </article>
  <!-- Presenter Notes -->
</slide>

    <slide class="backdrop"></slide>
  </slides>
  <div class="pagination pagination-small" id='io2012-ptoc' style="display:none;">
    <ul>
      <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=1 title='Introduction'>
         1
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=2 title='This presentation'>
         2
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=3 title='Installation'>
         3
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=4 title='Tour of RStudio IDE'>
         4
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=5 title='Vectors'>
         5
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=6 title='Vectors'>
         6
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=7 title='Lists'>
         7
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=8 title='Data Frames'>
         8
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=9 title='Packages'>
         9
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=10 title='Package Installation'>
         10
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=11 title='Case Study: U.S. REDTI'>
         11
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=12 title='Case Study: U.S. REDTI'>
         12
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=13 title='Case Study: U.S. REDTI'>
         13
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=14 title='Case Study: U.S. REDTI'>
         14
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=15 title='Case Study: U.S. REDTI'>
         15
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=16 title='Case Study: U.S. REDTI'>
         16
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=17 title='Case Study: U.S. REDTI'>
         17
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=18 title='Case Study: U.S. REDTI'>
         18
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=19 title='Case Study: U.S. REDTI'>
         19
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=20 title='Case Study: U.S. REDTI'>
         20
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=21 title='Case Study: U.S. REDTI'>
         21
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=22 title='Case Study: U.S. REDTI'>
         22
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=23 title='Case Study: U.S. REDTI'>
         23
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=24 title='Case Study: U.S. Energy 2012'>
         24
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=25 title='Case Study: U.S. Energy 2012'>
         25
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=26 title='Case Study: U.S. Energy 2012'>
         26
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=27 title='Case Study: U.S. Energy 2012'>
         27
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=28 title='Case Study: U.S. Energy 2012'>
         28
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=29 title='Case Study: U.S. Energy 2012'>
         29
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=30 title='Case Study: U.S. Energy 2012'>
         30
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=31 title='Case Study: U.S. Energy 2012'>
         31
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=32 title='Case Study: U.S. Energy 2012'>
         32
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=33 title='Case Study: U.S. Energy 2012'>
         33
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=34 title='Case Study: U.S. Energy 2012'>
         34
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=35 title='Further Learning'>
         35
      </a>
    </li>
  </ul>
  </div>  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
  <!-- Load Javascripts for Widgets -->
  
  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script> -->
  <script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>